"""
File: __init__.py
Author: MVU
Description: –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (Entry Point) –¥–ª—è –ø–∞–∫–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —É–∑–ª–æ–≤ MVU HTML Display.
             –û—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∫–ª–∞—Å—Å–æ–≤ —É–∑–ª–æ–≤, –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏
             –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –≤–µ–±-—Ä–µ—Å—É—Ä—Å–∞–º–∏ (JavaScript/CSS).
Location: custom_nodes/MVU-HTML-Display/__init__.py
"""

import sys
import logging
import importlib
from typing import Dict, Any

# ==============================================================================
# 1. –ù–ê–°–¢–†–û–ô–ö–ê –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø (LOGGING SETUP)
# ==============================================================================

# –°–æ–∑–¥–∞–µ–º –∏–º–µ–Ω–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä –¥–ª—è —á–µ—Ç–∫–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —ç—Ç–∞–ø–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
init_logger = logging.getLogger("MVU.HTMLDisplay.Init")
init_logger.setLevel(logging.INFO)

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–æ–≤ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
if not init_logger.handlers:
    handler = logging.StreamHandler(sys.stdout)
    formatter = logging.Formatter(
        '[%(asctime)s] [MVU-Init] [%(levelname)s] -> %(message)s',
        datefmt='%H:%M:%S'
    )
    handler.setFormatter(formatter)
    init_logger.addHandler(handler)

init_logger.info("–ù–∞—á–∞–ª–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞–∫–µ—Ç–∞ MVU HTML Display...")


# ==============================================================================
# 2. –ò–ú–ü–û–†–¢ –ú–û–î–£–õ–ï–ô –£–ó–õ–û–í (NODE IMPORTS)
# ==============================================================================

node_imported = False
MVUHTMLDisplayNode = None

try:
    # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å —É–∑–ª–∞ –∏–∑ —Ñ–∞–π–ª–∞ html_display_nodes.py
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç (.) –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –≤–Ω—É—Ç—Ä–∏ –ø–∞–∫–µ—Ç–∞
    from .html_display_nodes import MVUHTMLDisplayNode
    
    node_imported = True
    init_logger.info("–ú–æ–¥—É–ª—å 'html_display_nodes' —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω.")

except ImportError as e:
    init_logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –º–æ–¥—É–ª—è —É–∑–ª–∞: {e}")
except Exception as e:
    init_logger.error(f"–ù–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —É–∑–ª–∞: {e}", exc_info=True)


# ==============================================================================
# 3. –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –£–ó–õ–û–í (NODE MAPPINGS)
# ==============================================================================

# NODE_CLASS_MAPPINGS: –°–ª–æ–≤–∞—Ä—å, —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∏–º–µ–Ω–∞ —É–∑–ª–æ–≤
# —Å –∏—Ö Python-–∫–ª–∞—Å—Å–∞–º–∏. –≠—Ç–æ –∏–º—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ComfyUI –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ workflow.json.
NODE_CLASS_MAPPINGS: Dict[str, Any] = {}

# NODE_DISPLAY_NAME_MAPPINGS: –°–ª–æ–≤–∞—Ä—å, —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∏–º–µ–Ω–∞
# —Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –≤ –º–µ–Ω—é –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É–∑–ª–æ–≤ (UI).
NODE_DISPLAY_NAME_MAPPINGS: Dict[str, str] = {}

if node_imported and MVUHTMLDisplayNode is not None:
    # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á —É–∑–ª–∞
    NODE_KEY = "MVU_HTML_Display"
    
    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª–∞—Å—Å–∞
    NODE_CLASS_MAPPINGS[NODE_KEY] = MVUHTMLDisplayNode
    
    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–≥–æ –∏–º–µ–Ω–∏ (—Å —ç–º–æ–¥–∑–∏ –¥–ª—è —É–∑–Ω–∞–≤–∞–µ–º–æ—Å—Ç–∏)
    NODE_DISPLAY_NAME_MAPPINGS[NODE_KEY] = "MVU HTML Display üñ•Ô∏è"
    
    init_logger.info(f"–£–∑–µ–ª –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: {NODE_KEY} -> {NODE_DISPLAY_NAME_MAPPINGS[NODE_KEY]}")
else:
    init_logger.warning("–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É–∑–ª–æ–≤ –ø—Ä–æ–ø—É—â–µ–Ω–∞ –∏–∑-–∑–∞ –æ—à–∏–±–æ–∫ –∏–º–ø–æ—Ä—Ç–∞.")


# ==============================================================================
# 4. –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –í–ï–ë-–†–ï–°–£–†–°–û–í (WEB DIRECTORY)
# ==============================================================================

# –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è WEB_DIRECTORY —É–∫–∞–∑—ã–≤–∞–µ—Ç ComfyUI –ø—É—Ç—å –∫ –ø–∞–ø–∫–µ —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-—Å–∫—Ä–∏–ø—Ç–∞–º–∏.
# ComfyUI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç –≤—Å–µ .js —Ñ–∞–π–ª—ã –∏–∑ —ç—Ç–æ–π –ø–∞–ø–∫–∏.
# –ü—É—Ç—å —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∞–π–ª–∞ __init__.py.
WEB_DIRECTORY: str = "./web"

init_logger.info(f"–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –≤–µ–±-—Ä–µ—Å—É—Ä—Å–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: {WEB_DIRECTORY}")


# ==============================================================================
# 5. –≠–ö–°–ü–û–†–¢ (EXPORTS)
# ==============================================================================

# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–ª–æ–≤–∞—Ä–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—â–µ—Ç ComfyUI –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ custom node
__all__ = [
    "NODE_CLASS_MAPPINGS",
    "NODE_DISPLAY_NAME_MAPPINGS",
    "WEB_DIRECTORY"
]

init_logger.info("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞ MVU HTML Display –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ.")